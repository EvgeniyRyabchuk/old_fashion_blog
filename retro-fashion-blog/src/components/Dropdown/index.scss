@use '@scss/abstracts/index' as abs;

$dropdown-menu-min-width: 100%;
$appear-animation-time: 0.2s;
$header-link-hover-color: abs.$color-secondary;

.dropdown {
  -webkit-tap-highlight-color: transparent;
  position: relative;
  display: block;
  z-index: 999;

  .dropdown-menu {
    top: 100%;
    display: block;
    position: absolute;
    left: 0;
    min-width: $dropdown-menu-min-width;
    background: abs.$color-bg; // white background
    // border: 2px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);

    a {
      white-space: nowrap;
      color: abs.$color-text;
    }
    li:hover {
      color: $header-link-hover-color;
      background-color: $header-link-hover-color;
    }
    .dropdown-menu {
      top: 0;
      left: 100%;
    }
  }

  // action if its hoverable dropdown
  &.on-hover {
    &:hover {
      >.dropdown-menu {
        display: block;
        transition: top 1s ease-in-out;
      }
      &.root {
        >a::after {
          content: " ▲"; // for top-level
          font-size: 1em;
        }
      }
    }
    .dropdown-menu {
      display: none;
    }
  }

  // action if its clickable dropdown
  &.on-click {
    &.is-open {
      >.dropdown-menu {
        @include abs.animated-appear-via-max-height(true, $appear-animation-time);
      }
      &.root {
        >a::after {
          content: " ▲"; // for top-level
          font-size: 1em;
        }
      }
    }
    .dropdown-menu {
      @include abs.animated-appear-via-max-height(false, $appear-animation-time);
      li:hover {
        background-color: transparent !important;
        a { color: $header-link-hover-color !important; }
      }
    }
    // marker
    &:hover {
      &::after {
        display: block;
        content: "";
        width: 3px;
        background-color: black;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        max-height: 20px;
        margin: 20px 0;
      }
    }

  }

  // arrow adding
  &>a::after {
    content: " ▶"; // for nested
    font-size: 1em;
    margin: 5px 5px 5px 3px;
  }

  &.root {
    >a::after {
      content: " ▼"; // for top-level
      font-size: 1em;
      margin: 5px 5px 5px 3px;
    }
  }

}

@media screen and (max-width: abs.$xl-bp) {
  .dropdown {
    &:hover {
      background-color: transparent;
    }
    >a {
      &:hover {
        color: $header-link-hover-color !important;
      }
    }

    .dropdown-menu {
      position: static;
      box-shadow: none;
      border: 0;
    }

    &.on-hover:hover {
      >.dropdown-menu {
        display: none;
      }
    }

    &.on-click {
      &.is-open > .side-menu-item {
        padding-bottom: 10px;
      }
      .side-menu-item { transition: padding $appear-animation-time ease-in-out };
    }

    li { padding: 8px 15px !important; }

  }

}